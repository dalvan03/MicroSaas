/**
 * ID do documento modelo - substitua pelo ID do seu Google Docs Template
 */
var CONFIG = {
  TEMPLATE_ID: "1eX9mYAJ3dIokHN6FHqO9oCOmTrfdWGesMeIZlGj4nnM",
  FOLDER_ID: "18dIaAHczkEf-rfqjP6LwVfITqalOHjvp", // Substitua pelo ID da pasta de destino, se necessário
  ADMIN_EMAIL: "dalvanmiotto@gmail.com" // E-mail do administrador para grandes projetos
};

function testFormSubmit() {
  var e = {
    values: ["2025-01-14 15:30:00", "Nome Teste", "555-1234", "dalvanmiotto@gmail.com", "Condomínio X", "Endereço Y", "Cidade Z", "De 120 a 200", "2025-02-01"]
  };
  Logger.log("Objeto de evento simulado: " + JSON.stringify(e));
  onFormSubmit(e);
}

// Menos de 60
// De 60 a 120
// De 120 a 200
// De 200 a 260
// De 260 a 320

/**
 * Função principal acionada ao enviar o formulário.
 * e é o objeto de evento que contém as informações do formulário.
 */
function onFormSubmit(e) {
  try {
    Logger.log("Início do processamento do formulário.");

    // Validação do evento
    if (!e || !e.values) {
      throw new Error("Evento inválido ou sem valores. Verifique o gatilho ou os dados do formulário.");
    }

    // Extrai dados da linha recém adicionada
    var formData = getFormData(e);
    Logger.log("Dados do formulário extraídos: " + JSON.stringify(formData));

    // Validação básica dos dados
    if (!formData || !formData.nomeCompleto || !formData.email) {
      throw new Error("Dados do formulário estão incompletos ou inválidos.");
    }

    // Determina o número de módulos e verifica se é um grande projeto
    var modulos = determinarModulos(formData.qtdUnidades);
    Logger.log("Informações sobre módulos calculadas: " + JSON.stringify(modulos));

    if (modulos.grandeProjeto) {
      Logger.log("Projeto identificado como grande. Enviando e-mail ao administrador.");
      sendEmailToAdmin(formData);
      return; // Não gera orçamento para grandes projetos
    }


    // Cria objeto de substituições para o template com dados do formulário
    var replacements = createReplacements(formData, modulos);
    Logger.log("Substituições criadas: " + JSON.stringify(replacements));

    // Envolve apenas o trecho de cálculo do CODIGO em um try/catch
    try {
      var rowNumber = e.range.getRow();
      var codigoGerado = rowNumber + 5210;
      replacements["{{CODIGO}}"] = codigoGerado;
      Logger.log("CODIGO gerado: " + codigoGerado);
    } catch (err) {
      var codigoGerado = 5210;
      replacements["{{CODIGO}}"] = codigoGerado;
      Logger.log("Não foi possível calcular CODIGO: " + err);
      // Podemos continuar a execução normalmente
    }

    // Adiciona dados extras da planilha "Dados"
    appendDataReplacements(replacements, modulos);
    Logger.log("Dados adicionais da planilha aplicados.");

    // Gera o documento a partir do template com as substituições
    var newDocId = generateDocumentFromTemplate(CONFIG.TEMPLATE_ID, replacements, modulos);
    Logger.log("Documento gerado com ID: " + newDocId);


    // Converte o documento em PDF
    var pdfBlob = convertDocToPdf(newDocId);
    Logger.log("Documento convertido para PDF.");

    // Salvar PDF em uma pasta específica
    var folder = DriveApp.getFolderById(CONFIG.FOLDER_ID);
    folder.createFile(pdfBlob);
    Logger.log("PDF salvo na pasta de destino.");

    // Enviar PDF por e-mail
    sendEmail(pdfBlob, formData.email, "[Proposta Comercial] Airlcoker - Armários Inteligentes", createEmailBody(formData));
    Logger.log("PDF enviado por e-mail para: " + formData.email);

    // Envia notificação por e-mail
    sendEmailToAdminNew(formData);

  } catch (error) {
    Logger.log("Erro ao processar submissão: " + error.message);
  }
}


function generateDocumentFromTemplate(templateId, replacements, modulos) {
  var template = DriveApp.getFileById(templateId);
  var folder = DriveApp.getFolderById(CONFIG.FOLDER_ID);

  // Cria uma cópia do template na pasta de destino
  var newDoc = template.makeCopy("Orçamento Airlocker - " + replacements["{{NOME_CONDOMINIO}}"] + " - " + formatModuloString(modulos.modulosPrincipais, modulos.modulosAuxiliares) + " - " + replacements["{{CARIMBO}}"]);
  var newDocId = newDoc.getId();
  var doc = DocumentApp.openById(newDocId);


  // Remove a linha do módulo auxiliar caso não existam auxiliares
  if (modulos.modulosAuxiliares === 0) {
    Logger.log("Nenhum módulo auxiliar encontrado. Removendo a linha do documento.");
    removeAuxiliarRow(newDocId);
  }

  // Acessa as diferentes partes do documento
  var body = doc.getBody();
  var header = doc.getHeader();
  var footer = doc.getFooter();

  // Substitui no corpo
  replacePlaceholdersInElement(body, replacements);

  // Verifica e substitui no cabeçalho
  if (header) {
    Logger.log("Substituindo no Cabeçalho");
    replacePlaceholdersInElement(header, replacements);
  } else {
    Logger.log("Cabeçalho não encontrado.");
  }

  // Verifica e substitui no rodapé
  if (footer) {
    Logger.log("Substituindo no Rodapé");
    replacePlaceholdersInElement(footer, replacements);
  } else {
    Logger.log("Rodapé não encontrado.");
  }

  doc.saveAndClose();
  return newDocId;
}

function replacePlaceholdersInElement(element, replacements) {
  for (var placeholder in replacements) {
    var replaced = element.replaceText(placeholder, replacements[placeholder]);
    if (replaced) {
      Logger.log("Substituindo: " + placeholder + " por: " + replacements[placeholder]);
    } else {
      Logger.log("Não foi possível substituir o placeholder: " + placeholder);
    }
  }
}


/**
 * Formata a data para o formato dd/mm/aa.
 * @param {string} timestamp Carimbo de data/hora em formato ISO.
 * @return {string} Data formatada.
 */
function formatDate(timestamp) {
  var date = new Date(timestamp);
  var day = String(date.getDate()).padStart(2, "0");
  var month = String(date.getMonth() + 1).padStart(2, "0");
  var year = String(date.getFullYear()).slice(-2);
  return `${day}/${month}/${year}`;
}



/**
 * Converte o documento gerado em PDF.
 * @param {string} docId ID do documento gerado.
 * @return {Blob} Blob do PDF gerado.
 */
function convertDocToPdf(docId) {
  var doc = DriveApp.getFileById(docId);
  return doc.getAs("application/pdf");
}

/**
 * Envia um e-mail com o PDF gerado anexado.
 * @param {Blob} pdfBlob Blob do PDF a ser enviado.
 * @param {string} recipient E-mail do destinatário.
 * @param {string} subject Assunto do e-mail.
 * @param {string} body Corpo do e-mail.
 */
function sendEmail(pdfBlob, recipient, subject, body) {
  GmailApp.sendEmail(recipient, subject, "", {
    htmlBody: body,
    attachments: [pdfBlob]
  });
}



/**
 * Extrai os dados do envio do formulário a partir do objeto de evento.
 * @param {Object} e Evento do formulário contendo e.values.
 * @return {Object} Objeto com os dados extraídos.
 */
function getFormData(e) {
  var values = e.values;

  return {
    carimbo: values[0], // Carimbo de data/hora
    nomeCompleto: values[1], // Nome completo
    telefone: values[2], // Telefone
    email: values[3], // E-mail
    nomeCondominio: values[4], // Nome do condomínio
    endereco: values[5], // Endereço
    cidade: values[6], // Cidade
    qtdUnidades: values[7], // Quantidade de unidades habitacionais
    dataInstalacao: values[8] // Data de instalação
  };
}

/**
 * Determina o número de módulos com base na quantidade de unidades habitacionais.
 * @param {string} qtdUnidades Quantidade de unidades habitacionais.
 * @return {Object} Informações sobre os módulos e indicação de grande projeto.
 */
function determinarModulos(qtdUnidades) {
  var resultado = { modulosPrincipais: 0, modulosAuxiliares: 0, grandeProjeto: false };

  if (qtdUnidades === "Menos de 60") {
    resultado.modulosPrincipais = 1;
  } else if (qtdUnidades === "De 60 a 120") {
    resultado.modulosPrincipais = 1;
    resultado.modulosAuxiliares = 1;
  } else if (qtdUnidades === "De 120 a 200") {
    resultado.modulosPrincipais = 1;
    resultado.modulosAuxiliares = 2;
  } else if (qtdUnidades === "De 200 a 260") {
    resultado.modulosPrincipais = 2;
    resultado.modulosAuxiliares = 2;
  } else if (qtdUnidades === "De 260 a 320") {
    resultado.modulosPrincipais = 2;
    resultado.modulosAuxiliares = 3;
  } else if (qtdUnidades === "De 320 a 400") {
    resultado.modulosPrincipais = 2;
    resultado.modulosAuxiliares = 4;
  } else {
    resultado.grandeProjeto = true;
  }

  return resultado;
}




/**
 * Remove a linha do módulo auxiliar no documento se não houver auxiliares.
 * @param {string} docId ID do documento gerado.
 */
function removeAuxiliarRow(docId) {
  try {
    var doc = DocumentApp.openById(docId);
    var body = doc.getBody();
    Logger.log("Documento aberto com sucesso.");

    // Acessa todas as tabelas no documento
    var tables = body.getTables();
    var moduleFound = false;

    // Loop para verificar cada tabela no documento
    for (var i = 0; i < tables.length; i++) {
      var table = tables[i];

      // Percorre todas as linhas da tabela
      for (var row = 0; row < table.getNumRows(); row++) {
        // Percorre todas as células da linha
        for (var cell = 0; cell < table.getRow(row).getNumCells(); cell++) {
          var cellText = table.getRow(row).getCell(cell).getText();

          // Se encontrar o texto "{{MODULO_AUX}}", remove a linha
          if (cellText.indexOf("{{MODULO_AUX}}") !== -1) {
            table.removeRow(row);
            Logger.log("Linha do módulo auxiliar removida.");
            moduleFound = true;
            break;
          }
        }

        // Se já encontrou e removeu a linha, sai do loop
        if (moduleFound) {
          break;
        }
      }

      // Se já encontrou o módulo auxiliar, sai do loop da tabela
      if (moduleFound) {
        break;
      }
    }

    if (!moduleFound) {
      Logger.log("Módulo auxiliar não encontrado. Nenhuma remoção necessária.");
    }

    // Salva e fecha o documento
    //doc.save();
    Logger.log("Doc com sucesso.");

  } catch (error) {
    Logger.log("Erro ao remover a linha do módulo auxiliar: " + error.message);
  }
}



/**
 * Envia um e-mail para o administrador informando sobre um grande projeto.
 * @param {Object} formData Dados do formulário.
 */
function sendEmailToAdmin(formData) {
  var subject = "Novo grande projeto recebido";
  var body = "Um grande projeto foi recebido com as seguintes informações:\n" +
    "Nome: " + formData.nomeCompleto + "\n" +
    "E-mail: " + formData.email + "\n" +
    "Quantidade de unidades: " + formData.qtdUnidades;

  GmailApp.sendEmail(CONFIG.ADMIN_EMAIL, subject, body);
}


/**
 * Envia um e-mail para o administrador informando sobre um grande projeto.
 * @param {Object} formData Dados do formulário.
 */
function sendEmailToAdminNew(formData) {
  var subject = "Novo Orçamento Gerado - " + formData.qtdUnidades;
  var body = "Um novo orçamento foi gerado automáticamente:\n" +
    "Nome: " + formData.nomeCompleto + "\n" +
    "E-mail: " + formData.email + "\n" +
    "Quantidade de unidades: " + formData.qtdUnidades;

  GmailApp.sendEmail(CONFIG.ADMIN_EMAIL, subject, body);
}

/**
 * Cria objeto com as substituições chave-valor para o modelo do documento.
 * @param {Object} formData Dados extraídos do formulário.
 * @param {Object} modulos Informações sobre os módulos.
 * @return {Object} Objeto de substituições.
 */
function createReplacements(formData, modulos) {
  var replacements = {
    "{{CARIMBO}}": formatDate(new Date()),
    "{{NOME_COMPLETO}}": formData.nomeCompleto,
    "{{TELEFONE_CONTATO}}": formData.telefone,
    "{{EMAIL_CLIENTE}}": formData.email,
    "{{QTD_UNIDADES}}": formData.qtdUnidades,
    "{{NOME_CONDOMINIO}}": formData.nomeCondominio,
    "{{ENDERECO_CONDOMINIO}}": formData.endereco,
    "{{CIDADE_CONDOMINIO}}": formData.cidade,
    "{{MODULO_PRIN}}": modulos.modulosPrincipais + " Módulo Principal",
    "{{MODULO_AUX}}": modulos.modulosAuxiliares > 0 ? modulos.modulosAuxiliares + " Módulo Auxiliar" : "{{MODULO_AUX}}"
  };

  return replacements;
}

/**
 * Adiciona substituições vindas da planilha "Dados".
 * @param {Object} replacements Objeto de substituições.
 * @param {Object} modulos Informações sobre os módulos.
 */
function appendDataReplacements(replacements, modulos) {
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var sheetValores = ss.getSheetByName("Dados");

  if (!sheetValores) {
    throw new Error("A planilha 'Dados' não foi encontrada.");
  }


  replacements["{{QTD-PORTAS}}"] = gerarDescricaoPortas(modulos.modulosPrincipais,modulos.modulosAuxiliares);
  replacements["{{NUN-MODULOS}}"] = formatModuloString(modulos.modulosPrincipais, modulos.modulosAuxiliares);

  var valores;
  try {
    valores = sheetValores.getRange("B2:E3").getValues();
  } catch (error) {
    throw new Error("Erro ao acessar o intervalo 'B2:E3' na planilha 'Dados'.");
  }

  replacements["{{mp.12}}"] = valores[0][0] * modulos.modulosPrincipais;
  replacements["{{mp.24}}"] = valores[0][1] * modulos.modulosPrincipais;
  replacements["{{mp.36}}"] = valores[0][2] * modulos.modulosPrincipais;
  replacements["{{mp.48}}"] = valores[0][3] * modulos.modulosPrincipais;



  if (modulos.modulosAuxiliares > 0) {
    replacements["{{ma.12}}"] = valores[1][0] * modulos.modulosAuxiliares;
    replacements["{{ma.24}}"] = valores[1][1] * modulos.modulosAuxiliares;
    replacements["{{ma.36}}"] = valores[1][2] * modulos.modulosAuxiliares;
    replacements["{{ma.48}}"] = valores[1][3] * modulos.modulosAuxiliares;
  }

  replacements["{{d2.12}}"] = 0;
  replacements["{{v2.12}}"] = replacements["{{mp.12}}"] + (replacements["{{ma.12}}"] || 0);
  replacements["{{v2.24}}"] = replacements["{{mp.24}}"] + (replacements["{{ma.24}}"] || 0);
  replacements["{{v2.36}}"] = replacements["{{mp.36}}"] + (replacements["{{ma.36}}"] || 0);
  replacements["{{v2.48}}"] = replacements["{{mp.48}}"] + (replacements["{{ma.48}}"] || 0);

  replacements["{{d2.24}}"] = (replacements["{{v2.24}}"] - replacements["{{v2.12}}"]) * -1;
  replacements["{{d2.36}}"] = (replacements["{{v2.36}}"] - replacements["{{v2.12}}"]) * -1;
  replacements["{{d2.48}}"] = (replacements["{{v2.48}}"] - replacements["{{v2.12}}"]) * -1;
  var valores2;
  try {
    valores2 = sheetValores.getRange("B10:E11").getValues(); // Altere para o intervalo correto para os valores fixos
  } catch (error) {
    throw new Error("Erro ao acessar o intervalo 'B10:E11' na planilha 'Dados'.");
  }

  // Substituições para os valores fixos (instalação e frete)
  replacements["{{i.24}}"] = valores2[0][1];  // Instalação 24 meses
  replacements["{{i.12}}"] = valores2[0][0];  // Instalação 12 meses
  replacements["{{i.36}}"] = valores2[0][2];  // Instalação 36 meses
  replacements["{{i.48}}"] = valores2[0][3];  // Instalação 48 meses

  if (modulos.modulosAuxiliares > 0) {
    replacements["{{f.12}}"] =
      (valores2[1][0] * modulos.modulosAuxiliares * 0.8) + (valores2[1][0] * modulos.modulosPrincipais);  // Frete 12 meses
    replacements["{{f.24}}"] =
      (valores2[1][1] * modulos.modulosAuxiliares * 0.8) + (valores2[1][1] * modulos.modulosPrincipais);  // Frete 24 meses
    replacements["{{f.36}}"] =
      (valores2[1][2] * modulos.modulosAuxiliares * 0.8) + (valores2[1][2] * modulos.modulosPrincipais);  // Frete 36 meses
    replacements["{{f.48}}"] =
      (valores2[1][3] * modulos.modulosAuxiliares * 0.8) + (valores2[1][3] * modulos.modulosPrincipais);  // Frete 48 meses
  } else {
    replacements["{{f.12}}"] = valores2[1][0] * modulos.modulosPrincipais;  // Frete 12 meses
    replacements["{{f.24}}"] = valores2[1][1] * modulos.modulosPrincipais;  // Frete 24 meses
    replacements["{{f.36}}"] = valores2[1][2] * modulos.modulosPrincipais;  // Frete 36 meses
    replacements["{{f.48}}"] = valores2[1][3] * modulos.modulosPrincipais;  // Frete 48 meses
  }
  // Valores finais (considerando instalação, frete, e descontos)
  replacements["{{v.12}}"] = replacements["{{i.12}}"] + replacements["{{f.12}}"];  // Valor final 12 meses
  replacements["{{v.24}}"] = replacements["{{i.24}}"] + replacements["{{f.24}}"];  // Valor final 24 meses
  replacements["{{v.36}}"] = replacements["{{i.36}}"] + replacements["{{f.36}}"];  // Valor final 36 meses
  replacements["{{v.48}}"] = replacements["{{i.48}}"] + replacements["{{f.48}}"];  // Valor final 48 meses


  // Calcular os descontos (com base nos valores fixos)
  replacements["{{d.12}}"] = 0; // Desconto 12 meses
  replacements["{{d.24}}"] = (replacements["{{v.24}}"] - replacements["{{v.12}}"]) * -1;  // Desconto 24 meses
  replacements["{{d.36}}"] = (replacements["{{v.36}}"] - replacements["{{v.12}}"]) * -1;  // Desconto 36 meses
  replacements["{{d.48}}"] = (replacements["{{v.48}}"] - replacements["{{v.12}}"]) * -1;  // Desconto 48 meses




}

/**
 * Retorna uma string como:
 * - 1 Módulo Principal
 * - 1 Módulo Principal + 2 Módulos Auxiliares
 * - 2 Módulos Principais + 2 Módulos Auxiliares
 * de acordo com a quantidade.
 *
 * @param {number} princ Quantidade de módulos principais
 * @param {number} aux Quantidade de módulos auxiliares
 * @return {string} String resultante
 */
function formatModuloString(princ, aux) {
  var texto = "";

  // Parte de Módulo(s) Principal(is)
  if (princ > 0) {
    if (princ === 1) {
      texto += "1 Módulo Principal";
    } else {
      texto += princ + " Módulos Principais";
    }
  }

  // Se há principal e auxiliar, adiciona " + " no meio
  if (princ > 0 && aux > 0) {
    texto += " + ";
  }

  // Parte de Módulo(s) Auxiliar(es)
  if (aux > 0) {
    if (aux === 1) {
      texto += "1 Módulo Auxiliar";
    } else {
      texto += aux + " Módulos Auxiliares";
    }
  }

  // Caso não tenha nenhum módulo principal nem auxiliar
  if (princ === 0 && aux === 0) {
    texto = "Nenhum módulo selecionado";
  }

  return texto;
}

/**
 * Retorna algo como:
 * "9 Portas (6 Pequenas, 2 Médias e 1 Grande)"
 * "25 Portas (22 Pequenas, 2 Médias e 1 Grande)"
 * "41 Portas (38 Pequenas, 2 Médias e 1 Grande)"
 *
 * de acordo com modulosPrincipais e modulosAuxiliares.
 */
function gerarDescricaoPortas(modulosPrincipais, modulosAuxiliares) {
  // Cálculo de cada tipo
  var totalPequenas = (6 * modulosPrincipais) + (16 * modulosAuxiliares);
  var totalMedias = 2 * modulosPrincipais;
  var totalGrandes = 1 * modulosPrincipais;

  // Soma geral de portas
  var totalPortas = totalPequenas + totalMedias + totalGrandes;

  // Monta a string no formato desejado
  return totalPortas + " Portas ("
    + totalPequenas + " Pequenas, "
    + totalMedias + " Médias e "
    + totalGrandes + " Grande)";
}


/**
 * Cria um corpo de e-mail bem formatado e profissional.
 * @param {Object} formData Dados do formulário.
 * @return {string} Corpo do e-mail em HTML.
 */
function createEmailBody(formData) {
  return `

    <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
    <html xmlns="http://www.w3.org/1999/xhtml" xmlns:v="urn:schemas-microsoft-com:vml" xmlns:o="urn:schemas-microsoft-com:office:office" lang="en">
    <head>
    <title></title>
    <meta charset="UTF-8" />
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <!--[if !mso]>-->
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!--<![endif]-->
    <meta name="x-apple-disable-message-reformatting" content="" />
    <meta content="target-densitydpi=device-dpi" name="viewport" />
    <meta content="true" name="HandheldFriendly" />
    <meta content="width=device-width" name="viewport" />
    <meta name="format-detection" content="telephone=no, date=no, address=no, email=no, url=no" />
    <style type="text/css">
    table {
    border-collapse: separate;
    table-layout: fixed;
    mso-table-lspace: 0pt;
    mso-table-rspace: 0pt
    }
    table td {
    border-collapse: collapse
    }
    .ExternalClass {
    width: 100%
    }
    .ExternalClass,
    .ExternalClass p,
    .ExternalClass span,
    .ExternalClass font,
    .ExternalClass td,
    .ExternalClass div {
    line-height: 100%
    }
    body, a, li, p, h1, h2, h3 {
    -ms-text-size-adjust: 100%;
    -webkit-text-size-adjust: 100%;
    }
    html {
    -webkit-text-size-adjust: none !important
    }
    body, #innerTable {
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale
    }
    #innerTable img+div {
    display: none;
    display: none !important
    }
    img {
    Margin: 0;
    padding: 0;
    -ms-interpolation-mode: bicubic
    }
    h1, h2, h3, p, a {
    line-height: inherit;
    overflow-wrap: normal;
    white-space: normal;
    word-break: break-word
    }
    a {
    text-decoration: none
    }
    h1, h2, h3, p {
    min-width: 100%!important;
    width: 100%!important;
    max-width: 100%!important;
    display: inline-block!important;
    border: 0;
    padding: 0;
    margin: 0
    }
    a[x-apple-data-detectors] {
    color: inherit !important;
    text-decoration: none !important;
    font-size: inherit !important;
    font-family: inherit !important;
    font-weight: inherit !important;
    line-height: inherit !important
    }
    u + #body a {
    color: inherit;
    text-decoration: none;
    font-size: inherit;
    font-family: inherit;
    font-weight: inherit;
    line-height: inherit;
    }
    a[href^="mailto"],
    a[href^="tel"],
    a[href^="sms"] {
    color: inherit;
    text-decoration: none
    }
    </style>
    <style type="text/css">
    @media (min-width: 481px) {
    .hd { display: none!important }
    }
    </style>
    <style type="text/css">
    @media (max-width: 480px) {
    .hm { display: none!important }
    }
    </style>
    <style type="text/css">
    @media (max-width: 480px) {
    .t53{mso-line-height-alt:0px!important;line-height:0!important;display:none!important}.t54{padding-left:30px!important;padding-bottom:40px!important;padding-right:30px!important}.t56,.t66{width:480px!important}.t6{padding-bottom:20px!important}.t13,.t19,.t26,.t32,.t38,.t45,.t62,.t8{width:420px!important}.t5{line-height:28px!important;font-size:26px!important;letter-spacing:-1.04px!important}.t64{padding:40px 30px!important}.t1{padding-bottom:50px!important}.t3{width:80px!important}
    }
    </style>
    <!--[if !mso]>-->
    <link href="https://fonts.googleapis.com/css2?family=Albert+Sans:wght@400;500;700;800&amp;display=swap" rel="stylesheet" type="text/css" />
    <!--<![endif]-->
    <!--[if mso]>
    <xml>
    <o:OfficeDocumentSettings>
    <o:AllowPNG/>
    <o:PixelsPerInch>96</o:PixelsPerInch>
    </o:OfficeDocumentSettings>
    </xml>
    <![endif]-->
    </head>
    <body id="body" class="t70" style="min-width:100%;Margin:0px;padding:0px;background-color:#26074A;"><div class="t69" style="background-color:#26074A;"><table role="presentation" width="100%" cellpadding="0" cellspacing="0" border="0" align="center"><tr><td class="t68" style="font-size:0;line-height:0;mso-line-height-rule:exactly;background-color:#26074A;" valign="top" align="center">
    <!--[if mso]>
    <v:background xmlns:v="urn:schemas-microsoft-com:vml" fill="true" stroke="false">
    <v:fill color="#26074A"/>
    </v:background>
    <![endif]-->
    <table role="presentation" width="100%" cellpadding="0" cellspacing="0" border="0" align="center" id="innerTable"><tr><td><div class="t53" style="mso-line-height-rule:exactly;mso-line-height-alt:45px;line-height:45px;font-size:1px;display:block;">&nbsp;&nbsp;</div></td></tr><tr><td align="center">
    <table class="t57" role="presentation" cellpadding="0" cellspacing="0" style="Margin-left:auto;Margin-right:auto;">
    <tr>
    <!--[if mso]>
    <td width="600" class="t56" style="background-color:#F8F8F8;width:600px;">
    <![endif]-->
    <!--[if !mso]>-->
    <td class="t56" style="background-color:#F8F8F8;width:600px;">
    <!--<![endif]-->
    <table class="t55" role="presentation" cellpadding="0" cellspacing="0" width="100%" style="width:100%;"><tr>
    <td class="t54" style="padding:0 50px 60px 50px;"><table role="presentation" width="100%" cellpadding="0" cellspacing="0" style="width:100% !important;"><tr><td align="center">
    <table class="t4" role="presentation" cellpadding="0" cellspacing="0" style="Margin-left:auto;Margin-right:auto;">
    <tr>
    <!--[if mso]>
    <td width="255" class="t3" style="width:255px;">
    <![endif]-->
    <!--[if !mso]>-->
    <td class="t3" style="width:255px;">
    <!--<![endif]-->
    <table class="t2" role="presentation" cellpadding="0" cellspacing="0" width="100%" style="width:100%;"><tr>
    <td class="t1"><div style="font-size:0px;"><img class="t0" style="display:block;border:0;height:auto;width:100%;Margin:0;max-width:100%;" width="255" height="104.78125" alt="" src="https://airlockers.com.br/wp-content/uploads/2024/06/09ba1ace-172c-4d08-8af3-4396aa4e83ce.png"/></div></td>
    </tr></table>
    </td>
    </tr></table>
    </td></tr><tr><td align="center">
    <table class="t9" role="presentation" cellpadding="0" cellspacing="0" style="Margin-left:auto;Margin-right:auto;">
    <tr>
    <!--[if mso]>
    <td width="500" class="t8" style="width:500px;">
    <![endif]-->
    <!--[if !mso]>-->
    <td class="t8" style="width:500px;">
    <!--<![endif]-->
    <table class="t7" role="presentation" cellpadding="0" cellspacing="0" width="100%" style="width:100%;"><tr>
    <td class="t6" style="padding:0 0 15px 0;"><h1 class="t5" style="margin:0;Margin:0;font-family:Albert Sans,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Arial,sans-serif;line-height:26px;font-weight:800;font-style:normal;font-size:24px;text-decoration:none;text-transform:none;letter-spacing:-1.56px;direction:ltr;color:#191919;text-align:left;mso-line-height-rule:exactly;mso-text-raise:1px;">Proposta para: ${formData.nomeCondominio}</h1></td>
    </tr></table>
    </td>
    </tr></table>
    </td></tr><tr><td align="center">
    <table class="t14" role="presentation" cellpadding="0" cellspacing="0" style="Margin-left:auto;Margin-right:auto;">
    <tr>
    <!--[if mso]>
    <td width="500" class="t13" style="width:500px;">
    <![endif]-->
    <!--[if !mso]>-->
    <td class="t13" style="width:500px;">
    <!--<![endif]-->
    <table class="t12" role="presentation" cellpadding="0" cellspacing="0" width="100%" style="width:100%;"><tr>
    <td class="t11" style="padding:0 0 22px 0;"><p class="t10" style="margin:0;Margin:0;font-family:Albert Sans,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Arial,sans-serif;line-height:22px;font-weight:500;font-style:normal;font-size:14px;text-decoration:none;text-transform:none;letter-spacing:-0.56px;direction:ltr;color:#333333;text-align:left;mso-line-height-rule:exactly;mso-text-raise:2px;">Prezado(a) ${formData.nomeCompleto}</p></td>
    </tr></table>
    </td>
    </tr></table>
    </td></tr><tr><td align="center">
    <table class="t20" role="presentation" cellpadding="0" cellspacing="0" style="Margin-left:auto;Margin-right:auto;">
    <tr>
    <!--[if mso]>
    <td width="500" class="t19" style="width:500px;">
    <![endif]-->
    <!--[if !mso]>-->
    <td class="t19" style="width:500px;">
    <!--<![endif]-->
    <table class="t18" role="presentation" cellpadding="0" cellspacing="0" width="100%" style="width:100%;"><tr>
    <td class="t17" style="padding:0 0 22px 0;"><p class="t16" style="margin:0;Margin:0;font-family:Albert Sans,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Arial,sans-serif;line-height:22px;font-weight:500;font-style:normal;font-size:14px;text-decoration:none;text-transform:none;letter-spacing:-0.56px;direction:ltr;color:#333333;text-align:left;mso-line-height-rule:exactly;mso-text-raise:2px;">Meu nome é <span class="t15" style="margin:0;Margin:0;font-weight:700;mso-line-height-rule:exactly;">Dalvan</span>, sou diretor comercial da Airlocker em Porto Alegre e região metropolitana.</p></td>
    </tr></table>
    </td>
    </tr></table>
    </td></tr><tr><td align="center">
    <table class="t27" role="presentation" cellpadding="0" cellspacing="0" style="Margin-left:auto;Margin-right:auto;">
    <tr>
    <!--[if mso]>
    <td width="500" class="t26" style="width:500px;">
    <![endif]-->
    <!--[if !mso]>-->
    <td class="t26" style="width:500px;">
    <!--<![endif]-->
    <table class="t25" role="presentation" cellpadding="0" cellspacing="0" width="100%" style="width:100%;"><tr>
    <td class="t24" style="padding:0 0 22px 0;"><p class="t23" style="margin:0;Margin:0;font-family:Albert Sans,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Arial,sans-serif;line-height:22px;font-weight:500;font-style:normal;font-size:14px;text-decoration:none;text-transform:none;letter-spacing:-0.56px;direction:ltr;color:#333333;text-align:left;mso-line-height-rule:exactly;mso-text-raise:2px;"><span class="t21" style="margin:0;Margin:0;font-weight:700;mso-line-height-rule:exactly;">Obrigado </span>por entrar em contato com a Airlocker. Em <span class="t22" style="margin:0;Margin:0;font-weight:700;mso-line-height-rule:exactly;">anexo</span>, enviamos o orçamento detalhado solicitado para o seu condomínio.</p></td>
    </tr></table>
    </td>
    </tr></table>
    </td></tr><tr><td align="center">
    <table class="t33" role="presentation" cellpadding="0" cellspacing="0" style="Margin-left:auto;Margin-right:auto;">
    <tr>
    <!--[if mso]>
    <td width="500" class="t32" style="width:500px;">
    <![endif]-->
    <!--[if !mso]>-->
    <td class="t32" style="width:500px;">
    <!--<![endif]-->
    <table class="t31" role="presentation" cellpadding="0" cellspacing="0" width="100%" style="width:100%;"><tr>
    <td class="t30" style="padding:0 0 22px 0;"><p class="t29" style="margin:0;Margin:0;font-family:Albert Sans,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Arial,sans-serif;line-height:22px;font-weight:500;font-style:normal;font-size:14px;text-decoration:none;text-transform:none;letter-spacing:-0.56px;direction:ltr;color:#333333;text-align:left;mso-line-height-rule:exactly;mso-text-raise:2px;">Caso tenha dúvidas ou precise de mais informações, <span class="t28" style="margin:0;Margin:0;font-weight:700;mso-line-height-rule:exactly;">estamos à disposição</span> para ajudar. Não hesite em nos contatar através do telefone ou e-mail abaixo.</p></td>
    </tr></table>
    </td>
    </tr></table>
    </td></tr><tr><td align="center">
    <table class="t39" role="presentation" cellpadding="0" cellspacing="0" style="Margin-left:auto;Margin-right:auto;">
    <tr>
    <!--[if mso]>
    <td width="500" class="t38" style="width:500px;">
    <![endif]-->
    <!--[if !mso]>-->
    <td class="t38" style="width:500px;">
    <!--<![endif]-->
    <table class="t37" role="presentation" cellpadding="0" cellspacing="0" width="100%" style="width:100%;"><tr>
    <td class="t36"><p class="t35" style="margin:0;Margin:0;font-family:Albert Sans,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Arial,sans-serif;line-height:22px;font-weight:500;font-style:normal;font-size:14px;text-decoration:none;text-transform:none;letter-spacing:-0.56px;direction:ltr;color:#333333;text-align:left;mso-line-height-rule:exactly;mso-text-raise:2px;"><span class="t34" style="margin:0;Margin:0;font-weight:bold;mso-line-height-rule:exactly;">Contato</span></p></td>
    </tr></table>
    </td>
    </tr></table>
    </td></tr><tr><td align="center">
    <table class="t46" role="presentation" cellpadding="0" cellspacing="0" style="Margin-left:auto;Margin-right:auto;">
    <tr>
    <!--[if mso]>
    <td width="500" class="t45" style="width:500px;">
    <![endif]-->
    <!--[if !mso]>-->
    <td class="t45" style="width:500px;">
    <!--<![endif]-->
    <table class="t44" role="presentation" cellpadding="0" cellspacing="0" width="100%" style="width:100%;"><tr>
    <td class="t43"><p class="t42" style="margin:0;Margin:0;font-family:Albert Sans,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Arial,sans-serif;line-height:22px;font-weight:500;font-style:normal;font-size:14px;text-decoration:none;text-transform:none;letter-spacing:-0.56px;direction:ltr;color:#333333;text-align:left;mso-line-height-rule:exactly;mso-text-raise:2px;">Dalvan Miotto - Diretor Comercial POA e Região <br/><span class="t40" style="margin:0;Margin:0;font-weight:700;mso-line-height-rule:exactly;">Telefone: </span>51 99906-3747<br/><span class="t41" style="margin:0;Margin:0;font-weight:700;mso-line-height-rule:exactly;">E-mail:</span> dalvanmiotto@gmail.com</p></td>
    </tr></table>
    </td>
    </tr></table>
    </td></tr><tr><td><div class="t48" style="mso-line-height-rule:exactly;mso-line-height-alt:30px;line-height:30px;font-size:1px;display:block;">&nbsp;&nbsp;</div></td></tr><tr><td align="center">
    <table class="t52" role="presentation" cellpadding="0" cellspacing="0" style="Margin-left:auto;Margin-right:auto;">
    <tr>
    <!--[if mso]>
    <td width="400" class="t51" style="background-color:#005918;overflow:hidden;width:400px;border-radius:44px 44px 44px 44px;">
    <![endif]-->
    <!--[if !mso]>-->
    <td class="t51" style="background-color:#005918;overflow:hidden;width:400px;border-radius:44px 44px 44px 44px;">
    <!--<![endif]-->
    <table class="t50" role="presentation" cellpadding="0" cellspacing="0" width="100%" style="width:100%;"><tr>
    <td class="t49" style="text-align:center;line-height:44px;mso-line-height-rule:exactly;mso-text-raise:10px;"><a class="t47" href="https://wa.me/5551999063747?text=Ola%2C+meu+nome+%C3%A9+${formData.nomeCompleto}%2C+fiz+um+or%C3%A7amento+para+o+condom%C3%ADnio+${formData.nomeCondominio}." style="display:block;margin:0;Margin:0;font-family:Albert Sans,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Arial,sans-serif;line-height:44px;font-weight:800;font-style:normal;font-size:12px;text-decoration:none;letter-spacing:2.4px;direction:ltr;color:#F8F8F8;text-align:center;mso-line-height-rule:exactly;mso-text-raise:10px;" target="_blank">CONVERSAR NO WHATSAPP</a></td>
    </tr></table>
    </td>
    </tr></table>
    </td></tr></table></td>
    </tr></table>
    </td>
    </tr></table>
    </td></tr><tr><td align="center">
    <table class="t67" role="presentation" cellpadding="0" cellspacing="0" style="Margin-left:auto;Margin-right:auto;">
    <tr>
    <!--[if mso]>
    <td width="600" class="t66" style="background-color:#26074A;width:600px;">
    <![endif]-->
    <!--[if !mso]>-->
    <td class="t66" style="background-color:#26074A;width:600px;">
    <!--<![endif]-->
    <table class="t65" role="presentation" cellpadding="0" cellspacing="0" width="100%" style="width:100%;"><tr>
    <td class="t64" style="padding:48px 50px 48px 50px;"><table role="presentation" width="100%" cellpadding="0" cellspacing="0" style="width:100% !important;"><tr><td align="center">
    <table class="t63" role="presentation" cellpadding="0" cellspacing="0" style="Margin-left:auto;Margin-right:auto;">
    <tr>
    <!--[if mso]>
    <td width="500" class="t62" style="width:500px;">
    <![endif]-->
    <!--[if !mso]>-->
    <td class="t62" style="width:500px;">
    <!--<![endif]-->
    <table class="t61" role="presentation" cellpadding="0" cellspacing="0" width="100%" style="width:100%;"><tr>
    <td class="t60"><p class="t59" style="margin:0;Margin:0;font-family:Albert Sans,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Arial,sans-serif;line-height:22px;font-weight:500;font-style:normal;font-size:12px;text-decoration:none;text-transform:none;direction:ltr;color:#888888;text-align:center;mso-line-height-rule:exactly;mso-text-raise:3px;"><span class="t58" style="margin:0;Margin:0;font-weight:700;mso-line-height-rule:exactly;">Airlocker - Maior franquia de Smart Lockers do Brasil.</span></p></td>
    </tr></table>
    </td>
    </tr></table>
    </td></tr></table></td>
    </tr></table>
    </td>
    </tr></table>
    </td></tr></table></td></tr></table></div><div class="gmail-fix" style="display: none; white-space: nowrap; font: 15px courier; line-height: 0;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</div></body>
    </html>
      `;
}




